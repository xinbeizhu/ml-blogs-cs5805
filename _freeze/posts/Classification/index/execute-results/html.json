{
  "hash": "34c54b98a1c8e3a4ec7b9a49fe91d874",
  "result": {
    "markdown": "---\ntitle: Classification\nauthor: Xinbei Zhu\ndate: '2023-10-12'\ncategories:\n  - code\n  - analysis\nimage: classification.png\n---\n\nIn this blog post, I'll be discussing classification. Essentially, classification is a technique used in supervised machine learning, where the model is trained to accurately identify the label of any input data it receives. However, this concept is quite straightforward in practice.\n\nClassification is like sorting things into groups based on what they have in common. Imagine we have a box of toys, and we want to organize them. We might put all the cars in one group, all the dolls in another, and all the blocks in a third group. Each of these groups is like a category.\n\nIn the same way, in science and in everyday life, we classify things to understand and organize them better. For example, in a library, books are classified or sorted into groups like fiction, non-fiction, science, history, and so on. This helps us find what we're looking for more easily.\n\nIn the world of computers and technology, classification is used to teach computers how to recognize different types of things, like pictures of cats and dogs, or emails that are spam or not spam. The computer looks at the features (like shapes, colors, words) of each thing and learns to sort them into the right group.\n\nHowever, the advanced uses of classification go beyond basic tasks, significantly aiding in complex and vital areas. It's instrumental in environmental monitoring, where it analyzes satellite and sensor data for tracking changes like deforestation or urban development. In the banking and insurance sectors, it's crucial for fraud detection, identifying potential fraud to protect financial assets and privacy. Additionally, facial recognition technology, familiar in security and personal devices, relies on classification for identifying individuals.\n\nBut anyway, classification is just a fancy word for sorting or grouping things based on their features or characteristics.\n\n### Task Demo\n\nFor this blog, I would utilize the classification technology to predict a task related to finance as well, which is whether the loan of a person will be defaulted.\n\nI adopted a dataset called **Loan Default Prediction** from Kaggle.\n\nLet me import libaraies and load the dataset.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import precision_recall_curve\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\n%matplotlib inline\n```\n:::\n\n\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndf = pd.read_csv('datasets/Default_Fin.csv')\n```\n:::\n\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 10000 entries, 0 to 9999\nData columns (total 5 columns):\n #   Column         Non-Null Count  Dtype  \n---  ------         --------------  -----  \n 0   Index          10000 non-null  int64  \n 1   Employed       10000 non-null  int64  \n 2   Bank Balance   10000 non-null  float64\n 3   Annual Salary  10000 non-null  float64\n 4   Defaulted?     10000 non-null  int64  \ndtypes: float64(2), int64(3)\nmemory usage: 390.8 KB\n```\n:::\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nax = sns.countplot(data=df,x='Defaulted?')\nax.bar_label(ax.containers[0])\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n[Text(0, 0, '9667'), Text(0, 0, '333')]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-2.png){width=610 height=429}\n:::\n:::\n\n\nIn this plot, '0' represents loans are not defaulted and '1' represents defaulted. We can see that most people's loan is not defaulted, but there are still people's loan get defaulted.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nsns.scatterplot(data=df,y='Annual Salary',x='Bank Balance',hue='Defaulted?',alpha=0.5);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-7-output-1.png){width=619 height=429}\n:::\n:::\n\n\nThis plot shows that annual salary doesn't really affect loan defaults, as we can see that the orange spots, representing defaults, are spread out evenly up and down. On the other hand, the amount of money people have in their bank accounts does seem to matter. This is because all the orange spots are mostly on the right side. So, it suggests that loans with larger amounts are more likely to be defaulted on.\n\nLet's train our prediction model.\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\ndf = df.drop('Index',axis=1).copy()\n```\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nX = df.drop('Defaulted?', axis=1) \ny = df['Defaulted?']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# Model training\nmodel = RandomForestClassifier()\nmodel.fit(X_train, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier()</pre></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n# Model evaluation\npredictions = model.predict(X_test)\nprint(classification_report(y_test, predictions))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              precision    recall  f1-score   support\n\n           0       0.97      0.99      0.98      1931\n           1       0.49      0.26      0.34        69\n\n    accuracy                           0.96      2000\n   macro avg       0.73      0.63      0.66      2000\nweighted avg       0.96      0.96      0.96      2000\n\n```\n:::\n:::\n\n\nThrough this result, we can tell that the model is very effective in identifying class 0 instances but struggles with class 1 (low recall and precision for class 1). Besides, the high overall accuracy might be misleading due to the imbalance in the dataset. The performance on the minority class (class 1) is a concern.\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n# Predict probabilities\ny_scores = model.predict_proba(X_test)[:, 1]\n\n# Compute Precision-Recall values\nprecision, recall, thresholds = precision_recall_curve(y_test, y_scores)\n\n# Plot the Precision-Recall curve\nplt.figure()\nplt.plot(recall, precision, marker='.')\nplt.title('Precision-Recall Curve')\nplt.xlabel('Recall')\nplt.ylabel('Precision')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-11-output-1.png){width=589 height=449}\n:::\n:::\n\n\nThe PR (Precision-Recall) curve suggests that the model's performance is suboptimal. For PR curve: - The closer the curve is to the top-right corner of the plot, the better. - A good PR curve will show a gradual decline in precision as recall increases. A steep drop in precision would indicate that the classifier begins to make a lot of false positive errors as it tries to increase its recall. - The area under the PR curve is a useful metric. A larger area under the curve (closer to 1) indicates a better overall performance of the classifier.\n\nThe poor performance in this task may be due to an imbalance in the dataset between the number of defaulted and non-defaulted loans, combined with a limited range of features used.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}